<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-api/document-reports" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Document Reports | DocuDesk.app</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docudesk.app/docs/api/document-reports"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Document Reports | DocuDesk.app"><meta data-rh="true" name="description" content="DocuDesk provides comprehensive document analysis through its reporting system. This page explains how document reports work and how they can help you ensure your documents meet privacy, accessibility, and readability standards."><meta data-rh="true" property="og:description" content="DocuDesk provides comprehensive document analysis through its reporting system. This page explains how document reports work and how they can help you ensure your documents meet privacy, accessibility, and readability standards."><link data-rh="true" rel="canonical" href="https://docudesk.app/docs/api/document-reports"><link data-rh="true" rel="alternate" href="https://docudesk.app/docs/api/document-reports" hreflang="en"><link data-rh="true" rel="alternate" href="https://docudesk.app/docs/api/document-reports" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.0dac0f5f.css">
<script src="/assets/js/runtime~main.e9ef2ba9.js" defer="defer"></script>
<script src="/assets/js/main.ca345c99.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="DocuDesk Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="DocuDesk Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DocuDesk.app</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/api/openapi">Documentation</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/api">API Documentation</a><a href="https://github.com/conductionnl/docudesk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/api/openapi">api</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/openapi">API Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/document-processing">Document Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/api/document-reports">Document Reports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/anonymization-logs">Anonymization Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/presidio-integration">Entity Recognition Integration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/features/document-generation">features</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">DocuDesk Documentation</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">api</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Document Reports</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Document Reports</h1></header>
<p>DocuDesk provides comprehensive document analysis through its reporting system. This page explains how document reports work and how they can help you ensure your documents meet privacy, accessibility, and readability standards.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>The Document Reports system in DocuDesk enables you to:</p>
<ul>
<li>Identify files containing personal data</li>
<li>Categorize the types of personal data present</li>
<li>Track anonymization status</li>
<li>Manage retention periods</li>
<li>Document the legal basis for processing</li>
<li>Maintain an audit trail of privacy-related actions</li>
<li>Analyze documents for personal data that may require anonymization</li>
<li>Check documents for WCAG accessibility compliance</li>
<li>Assess the language level and readability of documents</li>
<li>Track document changes through file hashing</li>
<li>Generate detailed reports with actionable recommendations</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-report-generation">Automatic Report Generation<a href="#automatic-report-generation" class="hash-link" aria-label="Direct link to Automatic Report Generation" title="Direct link to Automatic Report Generation">​</a></h2>
<p>DocuDesk can automatically generate reports for documents as they are uploaded or modified in Nextcloud. This process works as follows:</p>
<ol>
<li>When a file is created or modified in Nextcloud, DocuDesk detects the event</li>
<li>A document log entry is created to maintain an audit trail</li>
<li>If reporting is enabled, DocuDesk checks if a report already exists for the current version of the file</li>
<li>If no report exists (or the file has changed), a new report is created with a &#x27;pending&#x27; status</li>
<li>Depending on the configuration, the report is either:<!-- -->
<ul>
<li>Processed immediately (synchronous processing)</li>
<li>Queued for processing by a background job (asynchronous processing)</li>
</ul>
</li>
<li>The report is updated with the analysis results once processing is complete</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="report-generation-workflow">Report Generation Workflow<a href="#report-generation-workflow" class="hash-link" aria-label="Direct link to Report Generation Workflow" title="Direct link to Report Generation Workflow">​</a></h3>
<p>The following sequence diagram illustrates the report generation process:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant User</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Nextcloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant FileEventListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant PresidioAPI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User-&gt;&gt;Nextcloud: Upload/Modify Document</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Nextcloud-&gt;&gt;FileEventListener: Trigger NodeCreatedEvent/NodeWrittenEvent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileEventListener-&gt;&gt;ReportingService: createReport()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ReportingService: calculateFileHash()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Check for existing report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt No existing report or file changed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ReportingService-&gt;&gt;ObjectService: Save new report (status: pending)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        alt Synchronous Processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ReportingService-&gt;&gt;ReportingService: processExistingReport()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ReportingService-&gt;&gt;ObjectService: Update report (status: processing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ReportingService-&gt;&gt;PresidioAPI: Analyze document</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PresidioAPI--&gt;&gt;ReportingService: Return analysis results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ReportingService-&gt;&gt;ObjectService: Update report with results (status: completed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else Asynchronous Processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Note over ReportingService: Report remains in pending status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Existing report found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ObjectService--&gt;&gt;ReportingService: Return existing report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService--&gt;&gt;FileEventListener: Return report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileEventListener--&gt;&gt;Nextcloud: Continue file operation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-options">Configuration Options<a href="#configuration-options" class="hash-link" aria-label="Direct link to Configuration Options" title="Direct link to Configuration Options">​</a></h3>
<p>The report generation process can be configured through the DocuDesk settings page:</p>
<ul>
<li><strong>Enable Reporting</strong>: Turn automatic report generation on or off</li>
<li><strong>Enable Anonymization</strong>: Turn automatic anonymization of sensitive data on or off</li>
<li><strong>Synchronous Processing</strong>: Choose between immediate processing or background job processing</li>
<li><strong>Confidence Threshold</strong>: Set the minimum confidence level for entity detection (0-100%)</li>
<li><strong>Store Original Text</strong>: Choose whether to store the original document text in reports</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="processing-modes">Processing Modes<a href="#processing-modes" class="hash-link" aria-label="Direct link to Processing Modes" title="Direct link to Processing Modes">​</a></h3>
<p>DocuDesk supports two processing modes for report generation:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="synchronous-processing">Synchronous Processing<a href="#synchronous-processing" class="hash-link" aria-label="Direct link to Synchronous Processing" title="Direct link to Synchronous Processing">​</a></h4>
<p>In synchronous mode, reports are generated immediately when a file is created or modified. This provides instant feedback but may impact performance for large files or high-traffic environments.</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant User</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant FileEventListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant PresidioAPI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User-&gt;&gt;FileEventListener: File Created/Modified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileEventListener-&gt;&gt;ReportingService: createReport(processNow=true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Save report (status: pending)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ReportingService: processExistingReport()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Update report (status: processing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;PresidioAPI: Send document for analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PresidioAPI--&gt;&gt;ReportingService: Return analysis results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Update report (status: completed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService--&gt;&gt;FileEventListener: Return completed report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileEventListener--&gt;&gt;User: File operation completes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-processing-recommended-for-production">Asynchronous Processing (Recommended for Production)<a href="#asynchronous-processing-recommended-for-production" class="hash-link" aria-label="Direct link to Asynchronous Processing (Recommended for Production)" title="Direct link to Asynchronous Processing (Recommended for Production)">​</a></h4>
<p>In asynchronous mode, reports are queued for processing by a background job that runs periodically. This is more efficient for large environments as it:</p>
<ul>
<li>Reduces the impact on user experience</li>
<li>Allows for better resource management</li>
<li>Handles large volumes of documents more effectively</li>
<li>Prevents timeouts when processing large files</li>
</ul>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant User</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant FileEventListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant BackgroundJob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant PresidioAPI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User-&gt;&gt;FileEventListener: File Created/Modified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileEventListener-&gt;&gt;ReportingService: createReport(processNow=false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Save report (status: pending)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService--&gt;&gt;FileEventListener: Return pending report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileEventListener--&gt;&gt;User: File operation completes immediately</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over BackgroundJob: Runs every 15 minutes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BackgroundJob-&gt;&gt;ReportingService: processPendingReports()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Fetch pending reports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService--&gt;&gt;ReportingService: Return pending reports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loop For each pending report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ReportingService-&gt;&gt;ObjectService: Update report (status: processing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ReportingService-&gt;&gt;PresidioAPI: Send document for analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PresidioAPI--&gt;&gt;ReportingService: Return analysis results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ReportingService-&gt;&gt;ObjectService: Update report (status: completed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The background job processes pending reports in batches, updating their status as they are completed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="document-report-object">Document Report Object<a href="#document-report-object" class="hash-link" aria-label="Direct link to Document Report Object" title="Direct link to Document Report Object">​</a></h2>
<p>The <code>DocumentReport</code> object is the core component for document analysis. It contains the results of various analyses performed on a document, including anonymization, WCAG compliance, and language level assessments.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-properties">Key Properties<a href="#key-properties" class="hash-link" aria-label="Direct link to Key Properties" title="Direct link to Key Properties">​</a></h3>
<table><thead><tr><th>Property</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>string</td><td>Unique identifier for the report</td></tr><tr><td>nodeId</td><td>string</td><td>Nextcloud node ID of the document</td></tr><tr><td>fileName</td><td>string</td><td>Name of the document</td></tr><tr><td>filePath</td><td>string</td><td>Full path to the document in Nextcloud</td></tr><tr><td>fileType</td><td>string</td><td>MIME type of the document (e.g., application/pdf)</td></tr><tr><td>fileExtension</td><td>string</td><td>File extension (e.g., pdf, docx)</td></tr><tr><td>fileSize</td><td>integer</td><td>Size of the file in bytes</td></tr><tr><td>fileHash</td><td>string</td><td>Hash of the file content to determine if a new report is needed</td></tr><tr><td>fileText</td><td>string</td><td>The extracted text content from the document, used for analysis</td></tr><tr><td>status</td><td>string</td><td>Status of the report generation (pending, processing, completed, failed)</td></tr><tr><td>errorMessage</td><td>string</td><td>Error message if report processing failed</td></tr><tr><td>riskScore</td><td>float</td><td>Numerical score indicating overall risk level (0-100)</td></tr><tr><td>riskLevel</td><td>string</td><td>Risk level classification (low, medium, high) based on risk score, or unknown if report is not completed</td></tr><tr><td>anonymizationResults</td><td>object</td><td>Results of anonymization analysis</td></tr><tr><td>entities</td><td>object</td><td>List of entities found made during anonymization</td></tr><tr><td>wcagComplianceResults</td><td>object</td><td>Results of WCAG compliance analysis</td></tr><tr><td>languageLevelResults</td><td>object</td><td>Results of language level analysis</td></tr><tr><td>retentionPeriod</td><td>integer</td><td>Retention period in days (0 for indefinite)</td></tr><tr><td>retentionExpiry</td><td>date-time</td><td>Date when the retention period expires</td></tr><tr><td>legalBasis</td><td>string</td><td>Legal basis for processing the data under GDPR</td></tr><tr><td>dataController</td><td>string</td><td>Name of the data controller</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="report-status-values">Report Status Values<a href="#report-status-values" class="hash-link" aria-label="Direct link to Report Status Values" title="Direct link to Report Status Values">​</a></h3>
<p>Reports can have the following status values:</p>
<ul>
<li><strong>pending</strong>: The report has been created but not yet processed</li>
<li><strong>processing</strong>: The report is currently being processed</li>
<li><strong>completed</strong>: The report has been successfully processed</li>
<li><strong>failed</strong>: The report processing failed (check errorMessage for details)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="handling-non-text-documents">Handling Non-Text Documents<a href="#handling-non-text-documents" class="hash-link" aria-label="Direct link to Handling Non-Text Documents" title="Direct link to Handling Non-Text Documents">​</a></h2>
<p>DocuDesk&#x27;s anonymization capabilities rely on text extraction from documents. However, certain file types cannot be processed for text content, which affects how DocuDesk handles these documents.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="unsupported-document-types">Unsupported Document Types<a href="#unsupported-document-types" class="hash-link" aria-label="Direct link to Unsupported Document Types" title="Direct link to Unsupported Document Types">​</a></h3>
<p>The following document types typically cannot be processed for text extraction:</p>
<ul>
<li><strong>Images</strong>: JPEG, PNG, GIF, BMP, WebP, etc.</li>
<li><strong>Videos</strong>: MP4, AVI, MOV, WebM, etc.</li>
<li><strong>Audio</strong>: MP3, WAV, FLAC, etc.</li>
<li><strong>Binary files</strong>: EXE, DLL, etc.</li>
<li><strong>Encrypted documents</strong>: Documents with password protection or encryption</li>
<li><strong>Scanned documents without OCR</strong>: Image-based PDFs without text layers</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-docudesk-handles-these-files">How DocuDesk Handles These Files<a href="#how-docudesk-handles-these-files" class="hash-link" aria-label="Direct link to How DocuDesk Handles These Files" title="Direct link to How DocuDesk Handles These Files">​</a></h3>
<p>When DocuDesk encounters a file that cannot be processed for text extraction:</p>
<ol>
<li>A report is still created for the document</li>
<li>The report status is set to &#x27;completed&#x27;</li>
<li>The anonymizationResults object will include:<!-- -->
<ul>
<li><code>containsPersonalData: false</code> (since no text could be analyzed)</li>
<li><code>anonymizationStatus: &#x27;not_required&#x27;</code></li>
<li><code>entitiesFound: []</code> (empty array)</li>
<li><code>totalEntitiesFound: 0</code></li>
</ul>
</li>
<li>The report will include an informational note indicating that text extraction was not possible</li>
<li>The riskLevel will typically be set to &#x27;unknown&#x27; since risk assessment requires text analysis</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-report-for-non-text-document">Example Report for Non-Text Document<a href="#example-report-for-non-text-document" class="hash-link" aria-label="Direct link to Example Report for Non-Text Document" title="Direct link to Example Report for Non-Text Document">​</a></h3>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;abc123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;nodeId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;456&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;fileName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;image.jpg&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;filePath&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/path/to/image.jpg&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;fileType&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;image/jpeg&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;fileExtension&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jpg&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;fileSize&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;fileHash&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a1b2c3d4e5f6&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;completed&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;riskLevel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;unknown&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;anonymizationResults&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;containsPersonalData&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;entitiesFound&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;totalEntitiesFound&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;dataCategories&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;anonymizationStatus&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;not_required&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;errorMessage&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;No text could be extracted from this document type&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices-for-non-text-documents">Best Practices for Non-Text Documents<a href="#best-practices-for-non-text-documents" class="hash-link" aria-label="Direct link to Best Practices for Non-Text Documents" title="Direct link to Best Practices for Non-Text Documents">​</a></h3>
<p>When working with non-text documents that might contain sensitive information:</p>
<ol>
<li><strong>Manual Review</strong>: Visually inspect images and videos for personal data</li>
<li><strong>Metadata Cleaning</strong>: Remove EXIF data from images which may contain location or device information</li>
<li><strong>OCR Processing</strong>: Consider using OCR tools on scanned documents before uploading</li>
<li><strong>Alternative Formats</strong>: When possible, provide text-based alternatives for important image-based content</li>
<li><strong>Custom Tagging</strong>: Use DocuDesk&#x27;s manual tagging features to mark non-text documents that contain sensitive information</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="report-creation-process">Report Creation Process<a href="#report-creation-process" class="hash-link" aria-label="Direct link to Report Creation Process" title="Direct link to Report Creation Process">​</a></h2>
<p>When a file event occurs (creation or modification), DocuDesk follows these steps to create or update reports:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flowchart TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[File Event Detected] --&gt; B[FileEventListener.handleNodeEvent]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; C[createReportForNode]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; D[ReportingService.createReportFromNode]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; E{Is reporting enabled?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|No| F[Skip report creation]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|Yes| G[Extract node properties]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; H{Does node have ETag?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt;|Yes| I[Use ETag as hash]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt;|No| J[Calculate content hash]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; K[Check for existing report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt; K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; L{Existing report found?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt;|No| M[Create new report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt;|Yes, same hash| N[Return existing report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt;|Yes, different hash| O[Update existing report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    O --&gt; P{Synchronous processing?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt; P</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt;|Yes| Q[Process report immediately]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt;|No| R[Save pending report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; S[Return completed report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    R --&gt; T[Return pending report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt; U[Return existing report]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="simplified-event-handling">Simplified Event Handling<a href="#simplified-event-handling" class="hash-link" aria-label="Direct link to Simplified Event Handling" title="Direct link to Simplified Event Handling">​</a></h3>
<p>DocuDesk has streamlined the report creation process by:</p>
<ol>
<li><strong>Centralizing Decision Logic</strong>: All decisions about whether to create reports and how to process them are now made in the ReportingService</li>
<li><strong>Automatic Processing Mode</strong>: The system automatically determines whether to process reports synchronously based on configuration settings</li>
<li><strong>Single Responsibility</strong>: Event listeners simply pass events to the ReportingService without making any decisions</li>
</ol>
<p>This approach ensures consistent behavior and makes the system easier to maintain and extend.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="report-update-logic">Report Update Logic<a href="#report-update-logic" class="hash-link" aria-label="Direct link to Report Update Logic" title="Direct link to Report Update Logic">​</a></h3>
<p>When a file is modified, DocuDesk updates the existing report rather than creating a new one:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant FL as FileEventListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant RS as ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant OS as ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FL-&gt;&gt;RS: createReportFromNode(node)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: Check if reporting is enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt Reporting Enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;OS: Get existing reports for node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OS--&gt;&gt;RS: Return existing reports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;RS: Determine processing mode (synchronous/asynchronous)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        alt Existing Report Found with Different Hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;RS: Update report with new hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;RS: Reset status to &quot;pending&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;OS: Save updated report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            alt Synchronous Processing Enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                RS-&gt;&gt;RS: Process report immediately</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else Existing Report Found with Same Hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;RS: Return existing report (no changes needed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else No Existing Report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;RS: Create new report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Reporting Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS--&gt;&gt;FL: Return null (no report created)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This logic ensures that reports are always up-to-date with the latest version of a file, while avoiding unnecessary processing when the file content hasn&#x27;t changed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="analysis-types">Analysis Types<a href="#analysis-types" class="hash-link" aria-label="Direct link to Analysis Types" title="Direct link to Analysis Types">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="anonymization-analysis">Anonymization Analysis<a href="#anonymization-analysis" class="hash-link" aria-label="Direct link to Anonymization Analysis" title="Direct link to Anonymization Analysis">​</a></h3>
<p>The anonymization analysis identifies personal data in documents that may need to be anonymized for GDPR compliance. It provides:</p>
<ul>
<li>Detection of various types of personal data (names, addresses, emails, etc.)</li>
<li>Count and categorization of personal data instances</li>
<li>Suggestions for anonymizing personal data</li>
<li>Confidence scores for detected entities</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wcag-compliance-analysis">WCAG Compliance Analysis<a href="#wcag-compliance-analysis" class="hash-link" aria-label="Direct link to WCAG Compliance Analysis" title="Direct link to WCAG Compliance Analysis">​</a></h3>
<p>The WCAG compliance analysis checks documents for accessibility issues according to the Web Content Accessibility Guidelines. It provides:</p>
<ul>
<li>Overall compliance level (A, AA, AAA, or non-compliant)</li>
<li>Breakdown of issues by severity and WCAG principle</li>
<li>Detailed list of accessibility issues with recommendations</li>
<li>Overall compliance score</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="language-level-analysis">Language Level Analysis<a href="#language-level-analysis" class="hash-link" aria-label="Direct link to Language Level Analysis" title="Direct link to Language Level Analysis">​</a></h3>
<p>The language level analysis assesses the readability and complexity of document text. It provides:</p>
<ul>
<li>Primary language detection</li>
<li>Various readability scores (Flesch-Kincaid, SMOG Index, etc.)</li>
<li>Text complexity metrics</li>
<li>Estimated education level required to understand the text</li>
<li>Suggestions for improving language clarity</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-categories">Data Categories<a href="#data-categories" class="hash-link" aria-label="Direct link to Data Categories" title="Direct link to Data Categories">​</a></h3>
<p>DocuDesk recognizes the following categories of personal data:</p>
<ul>
<li><strong>name</strong>: Names of individuals</li>
<li><strong>address</strong>: Physical addresses</li>
<li><strong>email</strong>: Email addresses</li>
<li><strong>phone</strong>: Phone numbers</li>
<li><strong>id_number</strong>: Identification numbers (passport, SSN, etc.)</li>
<li><strong>financial</strong>: Financial information (bank accounts, credit cards, etc.)</li>
<li><strong>health</strong>: Health-related information</li>
<li><strong>biometric</strong>: Biometric data</li>
<li><strong>location</strong>: Location data</li>
<li><strong>other</strong>: Other types of personal data</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="anonymization-status">Anonymization Status<a href="#anonymization-status" class="hash-link" aria-label="Direct link to Anonymization Status" title="Direct link to Anonymization Status">​</a></h3>
<p>The anonymization status can be one of the following:</p>
<ul>
<li><strong>not_required</strong>: The file does not require anonymization</li>
<li><strong>pending</strong>: Anonymization is pending</li>
<li><strong>in_progress</strong>: Anonymization is in progress</li>
<li><strong>completed</strong>: Anonymization is completed</li>
<li><strong>failed</strong>: Anonymization failed</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="legal-basis">Legal Basis<a href="#legal-basis" class="hash-link" aria-label="Direct link to Legal Basis" title="Direct link to Legal Basis">​</a></h3>
<p>Under GDPR, personal data processing must have a legal basis. DocuDesk supports tracking the following legal bases:</p>
<ul>
<li><strong>consent</strong>: The data subject has given consent</li>
<li><strong>contract</strong>: Processing is necessary for a contract</li>
<li><strong>legal_obligation</strong>: Processing is necessary for a legal obligation</li>
<li><strong>vital_interests</strong>: Processing is necessary to protect vital interests</li>
<li><strong>public_interest</strong>: Processing is necessary for a task in the public interest</li>
<li><strong>legitimate_interests</strong>: Processing is necessary for legitimate interests</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-endpoints">API Endpoints<a href="#api-endpoints" class="hash-link" aria-label="Direct link to API Endpoints" title="Direct link to API Endpoints">​</a></h2>
<p>DocuDesk provides the following API endpoints for managing document reports:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-flow">API Flow<a href="#api-flow" class="hash-link" aria-label="Direct link to API Flow" title="Direct link to API Flow">​</a></h3>
<p>The following diagram illustrates the typical flow when using the report API:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ReportController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Client-&gt;&gt;ReportController: POST /api/v1/reports (Create Report)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportController-&gt;&gt;ReportingService: createReport()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Save report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService--&gt;&gt;ReportingService: Return saved report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService--&gt;&gt;ReportController: Return report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportController--&gt;&gt;Client: Return JSON response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Client-&gt;&gt;ReportController: GET /api/v1/reports/{id} (Get Report)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportController-&gt;&gt;ObjectService: Get report by ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService--&gt;&gt;ReportController: Return report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportController--&gt;&gt;Client: Return JSON response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Client-&gt;&gt;ReportController: POST /api/v1/reports/{id}/process (Process Report)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportController-&gt;&gt;ReportingService: processExistingReport()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Update report status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;PresidioAPI: Analyze document</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PresidioAPI--&gt;&gt;ReportingService: Return analysis results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService-&gt;&gt;ObjectService: Update report with results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService--&gt;&gt;ReportingService: Return updated report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportingService--&gt;&gt;ReportController: Return processed report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReportController--&gt;&gt;Client: Return JSON response</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="list-document-reports">List Document Reports<a href="#list-document-reports" class="hash-link" aria-label="Direct link to List Document Reports" title="Direct link to List Document Reports">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /apps/docudesk/api/v1/reports</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Returns a list of document reports. You can filter the reports by:</p>
<ul>
<li><code>node_id</code>: Filter reports by Nextcloud node ID</li>
<li><code>status</code>: Filter reports by status</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-document-report">Create Document Report<a href="#create-document-report" class="hash-link" aria-label="Direct link to Create Document Report" title="Direct link to Create Document Report">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /apps/docudesk/api/v1/reports</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Creates a new document report. You need to specify:</p>
<ul>
<li><code>node_id</code>: Nextcloud node ID of the document</li>
<li><code>file_name</code>: Name of the document</li>
<li><code>file_path</code>: Full path to the document in Nextcloud</li>
<li><code>file_type</code>: MIME type of the document</li>
<li><code>file_extension</code>: File extension of the document</li>
<li><code>file_size</code>: Size of the file in bytes</li>
<li><code>file_hash</code>: Hash of the file content</li>
<li><code>analysis_types</code>: Types of analysis to perform (anonymization, wcag_compliance, language_level)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-document-report">Get Document Report<a href="#get-document-report" class="hash-link" aria-label="Direct link to Get Document Report" title="Direct link to Get Document Report">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /apps/docudesk/api/v1/reports/{reportId}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Returns a specific document report by ID.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-document-report">Update Document Report<a href="#update-document-report" class="hash-link" aria-label="Direct link to Update Document Report" title="Direct link to Update Document Report">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT /apps/docudesk/api/v1/reports/{reportId}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Updates a specific document report.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-latest-report-for-node">Get Latest Report for Node<a href="#get-latest-report-for-node" class="hash-link" aria-label="Direct link to Get Latest Report for Node" title="Direct link to Get Latest Report for Node">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /apps/docudesk/api/v1/reports/node/{nodeId}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Returns the latest document report for a specific Nextcloud node.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-report-configuration">Get Report Configuration<a href="#get-report-configuration" class="hash-link" aria-label="Direct link to Get Report Configuration" title="Direct link to Get Report Configuration">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /apps/docudesk/api/v1/settings/report</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Returns the current report configuration settings.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="save-report-configuration">Save Report Configuration<a href="#save-report-configuration" class="hash-link" aria-label="Direct link to Save Report Configuration" title="Direct link to Save Report Configuration">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /apps/docudesk/api/v1/settings/report</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Updates the report configuration settings. You can specify:</p>
<ul>
<li><code>enable_reporting</code>: Whether to enable automatic report generation</li>
<li><code>enable_anonymization</code>: Whether to enable automatic anonymization of sensitive data</li>
<li><code>synchronous_processing</code>: Whether to process reports immediately</li>
<li><code>confidence_threshold</code>: Minimum confidence level for entity detection (0-1)</li>
<li><code>store_original_text</code>: Whether to store the original document text in reports</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gdpr-compliance">GDPR Compliance<a href="#gdpr-compliance" class="hash-link" aria-label="Direct link to GDPR Compliance" title="Direct link to GDPR Compliance">​</a></h3>
<p>Document reports help ensure GDPR compliance by:</p>
<ul>
<li>Identifying documents containing personal data</li>
<li>Suggesting anonymization methods for sensitive information</li>
<li>Tracking anonymization status</li>
<li>Providing an audit trail of privacy-related actions</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessibility-compliance">Accessibility Compliance<a href="#accessibility-compliance" class="hash-link" aria-label="Direct link to Accessibility Compliance" title="Direct link to Accessibility Compliance">​</a></h3>
<p>Document reports help ensure accessibility compliance by:</p>
<ul>
<li>Checking documents against WCAG standards</li>
<li>Identifying accessibility issues</li>
<li>Providing recommendations for fixing issues</li>
<li>Tracking compliance levels over time</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="content-readability">Content Readability<a href="#content-readability" class="hash-link" aria-label="Direct link to Content Readability" title="Direct link to Content Readability">​</a></h3>
<p>Document reports help improve content readability by:</p>
<ul>
<li>Assessing the language level of documents</li>
<li>Identifying complex language</li>
<li>Suggesting simplifications</li>
<li>Ensuring content is appropriate for the target audience</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integration-with-document-processing">Integration with Document Processing<a href="#integration-with-document-processing" class="hash-link" aria-label="Direct link to Integration with Document Processing" title="Direct link to Integration with Document Processing">​</a></h2>
<p>The document reports system integrates with DocuDesk&#x27;s document processing capabilities:</p>
<ul>
<li>Reports can trigger automatic document processing (e.g., anonymization)</li>
<li>Processing results are reflected in updated reports</li>
<li>Reports provide a history of document transformations</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generating-a-document-report">Generating a Document Report<a href="#generating-a-document-report" class="hash-link" aria-label="Direct link to Generating a Document Report" title="Direct link to Generating a Document Report">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Create a new report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$reportData = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;node_id&#x27; =&gt; &#x27;12345&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;file_name&#x27; =&gt; &#x27;important-document.pdf&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;file_path&#x27; =&gt; &#x27;/Documents/important-document.pdf&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;file_type&#x27; =&gt; &#x27;application/pdf&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;file_extension&#x27; =&gt; &#x27;pdf&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;file_size&#x27; =&gt; 1024567,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;file_hash&#x27; =&gt; &#x27;a1b2c3d4e5f6g7h8i9j0&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;analysis_types&#x27; =&gt; [&#x27;anonymization&#x27;, &#x27;wcag_compliance&#x27;, &#x27;language_level&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$response = $client-&gt;post(&#x27;/apps/docudesk/api/v1/reports&#x27;, [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;json&#x27; =&gt; $reportData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$report = json_decode($response-&gt;getBody(), true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$reportId = $report[&#x27;id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Check report status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$response = $client-&gt;get(&#x27;/apps/docudesk/api/v1/reports/&#x27; . $reportId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$report = json_decode($response-&gt;getBody(), true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ($report[&#x27;status&#x27;] === &#x27;completed&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Process report results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $anonymizationResults = $report[&#x27;anonymization_results&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $wcagResults = $report[&#x27;wcag_compliance_results&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $languageResults = $report[&#x27;language_level_results&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Take action based on results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($anonymizationResults[&#x27;contains_personal_data&#x27;]) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Handle personal data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($wcagResults[&#x27;compliance_level&#x27;] !== &#x27;AA&#x27; &amp;&amp; $wcagResults[&#x27;compliance_level&#x27;] !== &#x27;AAA&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Address accessibility issues</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($languageResults[&#x27;education_level&#x27;] === &#x27;graduate&#x27; || $languageResults[&#x27;education_level&#x27;] === &#x27;professional&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Simplify language</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-report-generation">Configuring Report Generation<a href="#configuring-report-generation" class="hash-link" aria-label="Direct link to Configuring Report Generation" title="Direct link to Configuring Report Generation">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Update report configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$configData = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;enable_reporting&#x27; =&gt; true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;enable_anonymization&#x27; =&gt; true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;synchronous_processing&#x27; =&gt; false, // Use background jobs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;confidence_threshold&#x27; =&gt; 0.7,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;store_original_text&#x27; =&gt; true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$response = $client-&gt;post(&#x27;/apps/docudesk/api/v1/settings/report&#x27;, [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;json&#x27; =&gt; $configData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get current report configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$response = $client-&gt;get(&#x27;/apps/docudesk/api/v1/settings/report&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$config = json_decode($response-&gt;getBody(), true);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<ol>
<li><strong>Asynchronous Processing</strong>: For production environments, use asynchronous processing to reduce the impact on performance</li>
<li><strong>Regular Analysis</strong>: Regularly analyze important documents to ensure continued compliance</li>
<li><strong>Hash-Based Updates</strong>: Use file hashing to determine when documents have changed and need re-analysis</li>
<li><strong>Comprehensive Analysis</strong>: Use all three analysis types for critical documents</li>
<li><strong>Action on Results</strong>: Implement a workflow to address issues identified in reports</li>
<li><strong>Version Tracking</strong>: Keep reports for different versions of documents to track improvements</li>
<li><strong>Confidence Threshold</strong>: Adjust the confidence threshold based on your needs (higher for fewer false positives, lower for more comprehensive detection)</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Document reports provide a powerful way to ensure your documents meet privacy, accessibility, and readability standards. By automatically analyzing documents as they are created or modified, you can maintain compliance with regulations and improve the quality of your content without manual intervention.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-event-handling">File Event Handling<a href="#file-event-handling" class="hash-link" aria-label="Direct link to File Event Handling" title="Direct link to File Event Handling">​</a></h2>
<p>DocuDesk uses Nextcloud&#x27;s event system to detect file operations and trigger report generation. The following diagram illustrates how file events are handled:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flowchart TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subgraph Nextcloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        A[File Operation] --&gt;|Triggers| B[Event Dispatcher]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subgraph DocuDesk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        B --&gt;|Dispatches to| C[FileEventListener]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        C --&gt;|Validates| D[Is it a file?]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        D --&gt;|No| E[Ignore event]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        D --&gt;|Yes| F[Process event]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        F --&gt;|Handles| G[NodeCreatedEvent]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        F --&gt;|Handles| H[NodeWrittenEvent]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        F --&gt;|Handles| I[NodeDeletedEvent]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        F --&gt;|Handles| J[NodeTouchedEvent]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        G --&gt;|If reporting enabled| K[createReportForNode]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        H --&gt;|If reporting enabled| K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        K --&gt;|Calls| L[ReportingService.createReportFromNode]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        L --&gt;|Validates node is file| M[Extract node properties]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        M --&gt;|Check for ETag| N{ETag available?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        N --&gt;|Yes| O[Use ETag as hash]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        N --&gt;|No| P[Calculate hash]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        O --&gt; Q[Call createReport]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        P --&gt; Q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Q --&gt;|If processNow=true| R[Process immediately]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Q --&gt;|If processNow=false| S[Save pending report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The event listener handles different types of file events:</p>
<ul>
<li><strong>NodeCreatedEvent</strong>: Triggered when a new file is created</li>
<li><strong>NodeWrittenEvent</strong>: Triggered when a file&#x27;s content is modified</li>
<li><strong>NodeDeletedEvent</strong>: Triggered when a file is deleted</li>
<li><strong>NodeTouchedEvent</strong>: Triggered when a file&#x27;s metadata is updated</li>
</ul>
<p>For file creation and modification events, the listener creates reports if reporting is enabled.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="efficient-file-change-detection">Efficient File Change Detection<a href="#efficient-file-change-detection" class="hash-link" aria-label="Direct link to Efficient File Change Detection" title="Direct link to Efficient File Change Detection">​</a></h3>
<p>DocuDesk uses Nextcloud&#x27;s ETag (Entity Tag) system when available to efficiently detect file changes:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant FL as FileEventListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant RS as ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Node as Nextcloud Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FL-&gt;&gt;RS: createReportFromNode(node, processNow)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;Node: Check if getEtag() method exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt ETag available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Node--&gt;&gt;RS: Return ETag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;RS: Use ETag as file hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else ETag not available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;RS: Calculate hash from file content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: Check for existing report with same hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt No existing report or hash changed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;RS: Create new report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Existing report found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;RS: Return existing report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Using ETag provides several advantages:</p>
<ul>
<li><strong>Efficiency</strong>: Avoids reading file content for large files</li>
<li><strong>Accuracy</strong>: ETags change whenever file content changes</li>
<li><strong>Performance</strong>: Reduces CPU and I/O overhead</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="report-processing-workflow">Report Processing Workflow<a href="#report-processing-workflow" class="hash-link" aria-label="Direct link to Report Processing Workflow" title="Direct link to Report Processing Workflow">​</a></h2>
<p>The report processing workflow involves several steps and state transitions. The following diagram illustrates the lifecycle of a report:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stateDiagram-v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [*] --&gt; Pending: Report Created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Pending --&gt; Processing: processExistingReport called</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Processing --&gt; Completed: Analysis successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Processing --&gt; Failed: Analysis error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Completed --&gt; [*]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Failed --&gt; [*]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    note right of Pending</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Reports in pending state are</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        processed by the background job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    note right of Processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Report is being analyzed by</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Presidio API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    note right of Completed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Report contains analysis results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        and is ready for viewing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    note right of Failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Report contains error information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        and may be retried</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end note</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="report-processing-steps">Report Processing Steps<a href="#report-processing-steps" class="hash-link" aria-label="Direct link to Report Processing Steps" title="Direct link to Report Processing Steps">​</a></h3>
<p>The <code>ReportingService</code> handles report processing through the following steps:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Caller as Caller (EventListener/Controller/BackgroundJob)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant RS as ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant OS as ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant PA as Presidio API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Caller-&gt;&gt;RS: processExistingReport(report, filePath, fileName)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;OS: Update report status to &quot;processing&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: generateReport(filePath, documentId, documentTitle)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;PA: Send document for analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt Analysis Successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PA--&gt;&gt;RS: Return analysis results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;OS: Update report with results and status &quot;completed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OS--&gt;&gt;RS: Return updated report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Analysis Failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PA--&gt;&gt;RS: Return error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;OS: Update report with error and status &quot;failed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OS--&gt;&gt;RS: Return updated report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS--&gt;&gt;Caller: Return processed report</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This centralized processing approach ensures consistent handling of reports regardless of how they are triggered (file events, API requests, or background jobs).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="background-job-processing">Background Job Processing<a href="#background-job-processing" class="hash-link" aria-label="Direct link to Background Job Processing" title="Direct link to Background Job Processing">​</a></h2>
<p>DocuDesk uses a background job (<code>ProcessPendingReports</code>) to process pending reports asynchronously. This job runs periodically (every 15 minutes by default) and processes a batch of pending reports.</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flowchart TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[ProcessPendingReports job] --&gt;|Runs every 15 minutes| B{Is reporting enabled?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|No| C[Skip processing]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|Yes| D[Call ReportingService.processPendingReports]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt;|Fetch pending reports| E[ObjectService]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|Return pending reports| D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt;|For each report| F{Valid report?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt;|No| G[Mark as failed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt;|Yes| H[Process report]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt;|Call| I[ReportingService.processExistingReport]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt;|Update report status| J[ObjectService]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt;|Analyze document| K[Presidio API]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt;|Return results| I</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt;|Update report with results| J</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="background-job-sequence">Background Job Sequence<a href="#background-job-sequence" class="hash-link" aria-label="Direct link to Background Job Sequence" title="Direct link to Background Job Sequence">​</a></h3>
<p>The following sequence diagram illustrates how the background job processes pending reports:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Cron as Nextcloud Cron</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant PPR as ProcessPendingReports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant RS as ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant OS as ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant PA as Presidio API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Cron-&gt;&gt;PPR: Execute job (every 15 minutes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPR-&gt;&gt;RS: processPendingReports(MAX_REPORTS_PER_RUN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;OS: Get reports with status &quot;pending&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OS--&gt;&gt;RS: Return pending reports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loop For each pending report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RS-&gt;&gt;RS: Validate report (nodeId, filePath, fileName)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        alt Invalid report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;OS: Update report status to &quot;failed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else Valid report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;RS: processExistingReport(report, filePath, fileName)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;OS: Update report status to &quot;processing&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;PA: Send document for analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PA--&gt;&gt;RS: Return analysis results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RS-&gt;&gt;OS: Update report with results and status &quot;completed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS--&gt;&gt;PPR: Return number of processed reports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPR--&gt;&gt;Cron: Job completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This background processing approach allows DocuDesk to handle large volumes of documents efficiently without impacting user experience.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="entity-detection-and-risk-scoring">Entity Detection and Risk Scoring<a href="#entity-detection-and-risk-scoring" class="hash-link" aria-label="Direct link to Entity Detection and Risk Scoring" title="Direct link to Entity Detection and Risk Scoring">​</a></h2>
<p>DocuDesk uses the Presidio API to detect entities in documents and calculate risk scores based on the detected entities.</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flowchart TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Document Text] --&gt;|Sent to| B[Presidio API]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|Analyzes| C[Entity Detection]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|Returns| D[Detected Entities]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt;|Input for| E[Risk Score Calculation]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subgraph Risk Calculation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        E --&gt;|Consider| F[Entity Types]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        E --&gt;|Consider| G[Entity Counts]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        E --&gt;|Consider| H[Confidence Scores]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        F --&gt;|Apply| I[Type Weights]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        G --&gt;|Apply| J[Count Factor]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        H --&gt;|Apply| K[Confidence Factor]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        I --&gt; L[Weighted Sum]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        J --&gt; L</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        K --&gt; L</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        L --&gt;|Normalize| M[Final Risk Score]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        M --&gt;|Determine| N[Risk Level]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt;|Categorize as| O[Low/Medium/High/Critical]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="entity-detection-process">Entity Detection Process<a href="#entity-detection-process" class="hash-link" aria-label="Direct link to Entity Detection Process" title="Direct link to Entity Detection Process">​</a></h3>
<p>The following sequence diagram illustrates how entities are detected and risk scores are calculated:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant RS as ReportingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant PA as Presidio API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: generateReport(filePath, documentId, documentTitle)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: extractText(filePath)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: extractMetadata(filePath)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;PA: analyzeWithPresidio(text, threshold)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PA--&gt;&gt;RS: Return detected entities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: calculateRiskScore(entities)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over RS: Apply weights to different entity types</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over RS: Consider number of entities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over RS: Consider confidence scores</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: getRiskLevel(riskScore)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over RS: Categorize as Low/Medium/High/Critical</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;RS: createReportObject(text, presidioData, documentId, documentTitle, metadata)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RS-&gt;&gt;OS: saveObject(&#x27;report&#x27;, reportData)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OS--&gt;&gt;RS: Return saved report</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="risk-score-calculation">Risk Score Calculation<a href="#risk-score-calculation" class="hash-link" aria-label="Direct link to Risk Score Calculation" title="Direct link to Risk Score Calculation">​</a></h3>
<p>The risk score is calculated based on the following factors:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pie title Entity Type Weights</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;PERSON&quot; : 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;EMAIL_ADDRESS&quot; : 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;PHONE_NUMBER&quot; : 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;CREDIT_CARD&quot; : 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;IBAN_CODE&quot; : 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;LOCATION&quot; : 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;DATE_TIME&quot; : 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;OTHER&quot; : 4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The final risk score determines the risk level:</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph LR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Risk Score] --&gt; B{Risk Level}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|&lt; 20| C[Low]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|20-49| D[Medium]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|50-79| E[High]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|&gt;= 80| F[Critical]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This risk assessment helps organizations prioritize which documents need attention for privacy compliance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="risk-assessment-visualization">Risk Assessment Visualization<a href="#risk-assessment-visualization" class="hash-link" aria-label="Direct link to Risk Assessment Visualization" title="Direct link to Risk Assessment Visualization">​</a></h3>
<p>DocuDesk provides a comprehensive risk assessment visualization in the document details view. This feature helps users understand:</p>
<ol>
<li>The overall risk score of a document (0-100)</li>
<li>The risk level classification (Low, Medium, High, Critical)</li>
<li>The specific entities that contribute to the risk assessment</li>
<li>The weight of each entity type in the risk calculation</li>
</ol>
<p>The risk visualization includes:</p>
<ul>
<li>A color-coded risk score indicator (green for low risk, yellow for medium, red for high/critical)</li>
<li>A detailed breakdown of detected entity types and their counts</li>
<li>An explanation of the risk level and recommended actions</li>
<li>The weighting system used for different types of personal data</li>
</ul>
<p>This visual representation helps users quickly identify high-risk documents and understand why they are classified as such, enabling more effective privacy management and compliance efforts.</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flowchart TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Document Report] --&gt; B[Risk Assessment Section]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; C[Risk Score Indicator]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; D[Risk Level Classification]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; E[Entity Type Breakdown]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; F[Risk Explanation]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; G[Visual Representation]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; H[Action Recommendations]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; I[Entity Weights Display]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; J[Color-Coded Circle]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; K[Compliance Guidance]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; L[Prioritized Entity List]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The risk assessment visualization is particularly useful for:</p>
<ul>
<li>Privacy officers reviewing document collections</li>
<li>Compliance teams conducting audits</li>
<li>Content creators checking their documents before publication</li>
<li>Administrators monitoring organizational risk levels</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/conductionnl/docudesk/tree/main/website/docs/api/document-reports.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/api/document-processing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Document Processing</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/api/anonymization-logs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Anonymization Logs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#automatic-report-generation" class="table-of-contents__link toc-highlight">Automatic Report Generation</a><ul><li><a href="#report-generation-workflow" class="table-of-contents__link toc-highlight">Report Generation Workflow</a></li><li><a href="#configuration-options" class="table-of-contents__link toc-highlight">Configuration Options</a></li><li><a href="#processing-modes" class="table-of-contents__link toc-highlight">Processing Modes</a></li></ul></li><li><a href="#document-report-object" class="table-of-contents__link toc-highlight">Document Report Object</a><ul><li><a href="#key-properties" class="table-of-contents__link toc-highlight">Key Properties</a></li><li><a href="#report-status-values" class="table-of-contents__link toc-highlight">Report Status Values</a></li></ul></li><li><a href="#handling-non-text-documents" class="table-of-contents__link toc-highlight">Handling Non-Text Documents</a><ul><li><a href="#unsupported-document-types" class="table-of-contents__link toc-highlight">Unsupported Document Types</a></li><li><a href="#how-docudesk-handles-these-files" class="table-of-contents__link toc-highlight">How DocuDesk Handles These Files</a></li><li><a href="#example-report-for-non-text-document" class="table-of-contents__link toc-highlight">Example Report for Non-Text Document</a></li><li><a href="#best-practices-for-non-text-documents" class="table-of-contents__link toc-highlight">Best Practices for Non-Text Documents</a></li></ul></li><li><a href="#report-creation-process" class="table-of-contents__link toc-highlight">Report Creation Process</a><ul><li><a href="#simplified-event-handling" class="table-of-contents__link toc-highlight">Simplified Event Handling</a></li><li><a href="#report-update-logic" class="table-of-contents__link toc-highlight">Report Update Logic</a></li></ul></li><li><a href="#analysis-types" class="table-of-contents__link toc-highlight">Analysis Types</a><ul><li><a href="#anonymization-analysis" class="table-of-contents__link toc-highlight">Anonymization Analysis</a></li><li><a href="#wcag-compliance-analysis" class="table-of-contents__link toc-highlight">WCAG Compliance Analysis</a></li><li><a href="#language-level-analysis" class="table-of-contents__link toc-highlight">Language Level Analysis</a></li><li><a href="#data-categories" class="table-of-contents__link toc-highlight">Data Categories</a></li><li><a href="#anonymization-status" class="table-of-contents__link toc-highlight">Anonymization Status</a></li><li><a href="#legal-basis" class="table-of-contents__link toc-highlight">Legal Basis</a></li></ul></li><li><a href="#api-endpoints" class="table-of-contents__link toc-highlight">API Endpoints</a><ul><li><a href="#api-flow" class="table-of-contents__link toc-highlight">API Flow</a></li><li><a href="#list-document-reports" class="table-of-contents__link toc-highlight">List Document Reports</a></li><li><a href="#create-document-report" class="table-of-contents__link toc-highlight">Create Document Report</a></li><li><a href="#get-document-report" class="table-of-contents__link toc-highlight">Get Document Report</a></li><li><a href="#update-document-report" class="table-of-contents__link toc-highlight">Update Document Report</a></li><li><a href="#get-latest-report-for-node" class="table-of-contents__link toc-highlight">Get Latest Report for Node</a></li><li><a href="#get-report-configuration" class="table-of-contents__link toc-highlight">Get Report Configuration</a></li><li><a href="#save-report-configuration" class="table-of-contents__link toc-highlight">Save Report Configuration</a></li></ul></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a><ul><li><a href="#gdpr-compliance" class="table-of-contents__link toc-highlight">GDPR Compliance</a></li><li><a href="#accessibility-compliance" class="table-of-contents__link toc-highlight">Accessibility Compliance</a></li><li><a href="#content-readability" class="table-of-contents__link toc-highlight">Content Readability</a></li></ul></li><li><a href="#integration-with-document-processing" class="table-of-contents__link toc-highlight">Integration with Document Processing</a></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a><ul><li><a href="#generating-a-document-report" class="table-of-contents__link toc-highlight">Generating a Document Report</a></li><li><a href="#configuring-report-generation" class="table-of-contents__link toc-highlight">Configuring Report Generation</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#file-event-handling" class="table-of-contents__link toc-highlight">File Event Handling</a><ul><li><a href="#efficient-file-change-detection" class="table-of-contents__link toc-highlight">Efficient File Change Detection</a></li></ul></li><li><a href="#report-processing-workflow" class="table-of-contents__link toc-highlight">Report Processing Workflow</a><ul><li><a href="#report-processing-steps" class="table-of-contents__link toc-highlight">Report Processing Steps</a></li></ul></li><li><a href="#background-job-processing" class="table-of-contents__link toc-highlight">Background Job Processing</a><ul><li><a href="#background-job-sequence" class="table-of-contents__link toc-highlight">Background Job Sequence</a></li></ul></li><li><a href="#entity-detection-and-risk-scoring" class="table-of-contents__link toc-highlight">Entity Detection and Risk Scoring</a><ul><li><a href="#entity-detection-process" class="table-of-contents__link toc-highlight">Entity Detection Process</a></li><li><a href="#risk-score-calculation" class="table-of-contents__link toc-highlight">Risk Score Calculation</a></li><li><a href="#risk-assessment-visualization" class="table-of-contents__link toc-highlight">Risk Assessment Visualization</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/conductionnl/docudesk" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Gemeente Hoekse Waard. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>